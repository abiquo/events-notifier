1. Introduction

Abiquo events-notifier is a Python script that connects to Abiquo API OUTBOUND stream and notifies events through email based on rules.
This script works with Abiquo 2.6 API Outbound

2. Configuration

    * This script has been tested with Python 2.6 and 2.7
        With lower and higher Python versions events-notifier may experience unexpected behaviour

    * Install the required python libraries:
	python-dateutil   
	python-pycurl 
 
    * Edit notifier.cfg and set correct values. More information at:
	http://wiki.abiquo.com/display/ABI26/Abiquo+Events+Notifier

    * Initialize rules
        You can edit rules.cfg file directly or use the built in rule editor interface.
        To use rule editor interface you just need to start ./main.py and connect to the correspondent URL through a web browser.
        
3. Basic example

    * Rule that monitor VIRTUAL_APPLIANCE creation from all enterprises and notify admin@example.com:
        { "mailto" : "admin@example.com" , "action" : "CREATE" , "entity" : "VIRTUAL_APPLIANCE" , "severity" : "all" , "user" : "all" , "enterprise" : "all" }
        

    * Rule that monitor user login with ID 1 from enterprise with ID 1 and notify admin@example.com:
        { "mailto" : "admin@example.com" , "action" : "LOGIN" , "entity" : "all" , "severity" : "all" , "user" : "1" , "enterprise" : "1" }

    Rules.cfg is a strict format file, each line is a rule and each rule is a JSON dictionary with indicated atributes. Any malformed line may interfere in the events-notifier.


    * Run the Events Notifier

        # ./main.py &
        
        
4. Final notes

    * Add/delete rules while Notifier is running is ALLOWED. Rules.cfg file is checked every 60 seconds and if has been modified within that period new rules are loaded/deleted.

TO-DO
- Enable/disable rule editor
- Control access to rule editor

